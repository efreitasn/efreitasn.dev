<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#0e0e0e"><title>ANSI escape codes - efreitasn</title><meta name="description" content="Printing custom strings in your terminal."><meta property="og:type" content="article"><meta property="og:url" content="https://efreitasn.dev/posts/ansi-escape-codes"><meta property="og:title" content="ANSI escape codes - efreitasn"><meta property="og:description" content="Printing custom strings in your terminal."><meta property="og:image:url" content="https://efreitasn.dev/assets/4b0ea0fd6cfb37a3793316b024726da7/1920.png"><meta property="og:image:alt" content="efreitasn.dev's logo"><meta property="article:published_time" content="2019-09-08T16:37:00Z"><meta property="article:modified_time" content="2020-03-08T03:27:00Z"><meta property="twitter:image:alt" content="efreitasn.dev's logo"><meta property="twitter:site" content="@efreitasn"><meta property="twitter:creator" content="@efreitasn"><link rel="icon" href="/assets/30ba753e7ca8f6dd067d57b3b85ef622/192.png"><link rel="apple-touch-icon" href="/assets/30ba753e7ca8f6dd067d57b3b85ef622/192.png"><link rel="alternate" hreflang="en" href="https://efreitasn.dev/posts/ansi-escape-codes"><link rel="alternate" hreflang="pt-br" href="https://efreitasn.dev/pt-BR/posts/ansi-escape-codes"><link rel="stylesheet" href="/assets/style-81951af889b3f04b943a212670d9405d.css"><script>
  window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) }; ga.l = +new Date;
  ga('create', 'UA-136259822-1', 'auto');
  ga('send', 'pageview');
</script><script async src="https://www.google-analytics.com/analytics.js"></script></head><body><div class="wrapper"><header class="header"><h1 class="header__title"><a href="/">efreitasn</a></h1></header><main class="main"><article><header class="post-header"><h1 class="post-header__title">ANSI escape codes</h1><p class="post-header__dates"><span>Created:</span>
<time>2019-09-08T16:37:00Z</time><br><span>Last updated:</span>
<time>2020-03-08T03:27:00Z</time></p></header><div class="post-content"><p>Have you ever wondered how is it that some CLIs print a custom text in your terminal? By custom I mean: italic, bold, with foreground and/or background colors different than the default ones etc. The secret, so to speak, is something called ANSI escape codes.</p><h2>What they are</h2><p>Basically, ANSI escape codes are sequences of characters that start with <code>ESC</code> and are interpreted as commands instead of solely characters. They were created because, back when actual terminals were used, there was a need to standardize how manufacturers could print special characters to the user using these devices. It was a need because the manufacturers were creating their own versions of escape codes to use in their own devices. This, <a href="https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/">just as what happened with character encodings before Unicode</a>, created compatibility issues. Therefore, to address these issues, the ANSI escape codes were created.</p><p>Now, a few decades later, terminals aren't used anymore, but ANSI escape codes are still around. This time, though, they're used in our day-to-day terminal emulators. Just to make things clear, even though they don't mean the exact same thing, I use terminal and terminal emulator interchangeably in this post.</p><h2>Attributes</h2><p>In the ANSI escape codes, attributes are defined through codes. You define a sequence of attributes between <code>ESC[</code> and <code>m</code>, separating them with a <code>;</code>. For instance, an underlined string with a 4 bit color green background would be</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[4;42mSomeText&#34;</span>
</pre><p>Notice that it starts with <code>\x1b[</code>, which is <code>ESC[</code>, but with the <code>ESC</code> character in its hexadecimal ASCII representation since it's not a printable character. <code>1</code> is the code of the italic attribute, while <code>42</code> is the code of the green background attribute. The <code>m</code> before <code>SomeText</code> indicates the end of the attributes sequence, making <code>SomeText</code> the part that is actually printed to the user with both attributes applied.</p><h3>Colors</h3><p>When it comes to color attributes, there are three groups: 4 bit colors, 8 bit colors and 24 bit colors.</p><h4>4 bit colors</h4><p>First, we have the 4 bit colors. 4 bit colors are composed by red, green, blue, black, white, cyan, magenta, yellow and one brighter version of each one of them. That way, we got 16 colors to use as foreground and/or background colors.</p><p>The ranges 30-37 and 90-97 comprise the foreground colors, while the ranges 40-47 and 100-107 comprise the background colors.</p><p>Let's assume we're building a testing CLI tool and we want a string with a white foreground and a red background to demonstrate a failed test. To do that, we'd use something like</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[37;41mFAIL&#34;</span>
</pre><h4>8 bit colors</h4><p>16 colors are good and all, but what about 256? In this second group of colors, there are 4 ranges. The first one, 0-7, is the same as the 4 bit colors range 30-37, while the second, 8-15, is the same as the 4 bit colors range 90-97. The last two are 16-231, which comprises colors that were not present in the 4 bit colors group, and 232-255, which is a scale from black to white.</p><p>Unlike the previous group, the code of the color doesn't change depending on whether you want to use it in the foreground or in the background. If you want the color to be used in the foreground, you start the sequence with <code>38;5</code>. If you want it in the background, then you start the sequence with <code>48;5</code>.</p><p>As I said, the last range comprise a scale of black to white. So, let's suppose we want a gray (<code>240</code>) foreground color. We could get it by writing</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[38;5;240mText&#34;</span>
</pre><h4>24 bit colors</h4><p>Ok, so we increment the number of possible colors by a few bits with 24 bit colors. With them, we have over 16 million possible colors. This group, also known by the name true color, is like the colors used in HTML and CSS where we can represent red, green and blue with two hexadecimal digits (1 byte) each.</p><p>A 24 bit color syntax is</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[38;2;RED;GREEN;BLUEm&#34;</span> <span class="c1"># Foreground</span>
<span class="nb">echo</span> -e <span class="s2">&#34;\x1b[48;2;RED;GREEN;BLUEm&#34;</span> <span class="c1"># Background</span>
</pre><p>Similar to the CSS <code>rgb()</code> function, <code>RED</code>, <code>GREEN</code> and <code>BLUE</code> are numbers in the range 0-255.</p><p>In case you want to check how many colors your terminal supports, there's this <a href="https://unix.stackexchange.com/q/23763">Stack Exchange question</a> and <a href="https://gist.github.com/XVilka/8346728">this gist</a> that might help.</p><h3>Other attributes</h3><p>There are not only colors in ANSI escape codes attributes. As I said in the beginning of the post, we can do other things like making a string bold or italic.</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[1mText&#34;</span> <span class="c1"># Bold</span>
<span class="nb">echo</span> -e <span class="s2">&#34;\x1b[3mText&#34;</span> <span class="c1"># Italic</span>
<span class="nb">echo</span> -e <span class="s2">&#34;\x1b[4mText&#34;</span> <span class="c1"># Underline</span>
<span class="nb">echo</span> -e <span class="s2">&#34;\x1b[9mText&#34;</span> <span class="c1"># Strikethrough</span>
</pre><h3>Combining them</h3><p>None of the attributes I mentioned above are exclusive. Yes, that means we can make, for instance, a bold, italic, underlined and crossed yellow string with a blue background</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[1;3;4;9;33;44mText&#34;</span>
</pre><h3>Resetting all</h3><p>What if we want to print something in the same line as the custom text above but without any attributes? Well, we could use the attribute of code <code>0</code>, which is used to reset all attributes. So it would be something like this</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[1;3;4;9;33;44mText\x1b[0mOtherText&#34;</span>
</pre><p>While <code>Text</code> would have all the specified attributes applied, <code>OtherText</code> would have the default attributes of your terminal.</p><h2>customo</h2><p>customo is a package I wrote in go to help create custom strings using ANSI escape codes attributes. <a href="https://github.com/efreitasn/customo">The project is available on GitHub</a> and it supports all attributes mentioned in this post. It also appends <code>\x1b[0m</code> to a custom string automatically, avoiding <em>an attributes leak</em>. For instance,</p><pre class="chroma"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;fmt&#34;</span>

	<span class="s">&#34;github.com/efreitasn/customo&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">(</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">str</span> <span class="o">:=</span> <span class="nx">customo</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span>
		<span class="s">&#34;Custom&#34;</span><span class="p">,</span>
		<span class="nx">customo</span><span class="p">.</span><span class="nx">AttrBold</span><span class="p">,</span>
		<span class="nx">customo</span><span class="p">.</span><span class="nx">AttrUnderline</span><span class="p">,</span>
		<span class="nx">customo</span><span class="p">.</span><span class="nf">AttrFgColor24Bits</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="p">,</span>
		<span class="nx">customo</span><span class="p">.</span><span class="nf">AttrBgColor24Bits</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="p">,</span>
	<span class="p">)</span>

	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span>
<span class="p">}</span>
</pre><p>is equivalent to</p><pre class="chroma"><span class="nb">echo</span> -e <span class="s2">&#34;\x1b[1;4;38;2;255;255;255;48;2;0;0;255mCustom\x1b[0m&#34;</span>
</pre><p>which is an underlined, bold string with a 24 bits white color in the foreground and a 24 bits blue color in the background.</p><h2>Conclusion</h2><p>I didn't mention all codes. I mean, I didn't even mention the codes related to cursor position or put a table showing all the possible combinations of colors. If you're looking for said tables or the full list of characters, you can have look at <a href="https://en.wikipedia.org/wiki/ANSI_escape_code">this Wikipedia page</a>.</p></div><footer class="post-footer"><a href="https://github.com/efreitasn/efreitasn.dev/blob/master/content/posts/ansi-escape-codes/content_en.md">Edit on GitHub</a></footer></article></main><footer class="footer"><nav class="footer-nav"><ul><li><a href="https://github.com/efreitasn/efreitasn.dev">GitHub</a></li><li><a href="/posts/about">About</a></li><li><a href="/pt-BR/posts/ansi-escape-codes">Português do Brasil</a></li></ul></nav></footer></div></body></html>